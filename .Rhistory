par(opar)
tiff(filename="./outputs/Figure_5_understory_effects.tiff",
type="cairo",
units="in",
width = 7,
height=5,
pointsize=15,
compression = "lzw",
res=600)
layout(matrix(c(1,2,3,4,5,6), nrow = 2, ncol = 3, byrow = TRUE))
par(oma = c(2,4,0,0), mar = c(3,1,1,1), bty = 'n')
plot(NA,
ylim = c(0,.12),
xlim = c(I(min(plot_data$Tree_cover)*100), I(max(plot_data$Tree_cover)*100)),
xlab = "",
ylab = "",
bg='grey60',
col = 'grey30',
pch = 21,
cex.lab = 1.5,
bty = 'n',
xaxt = 'n',
yaxt = 'n')
lines(inv.as(preds_tc_cg$predictions) ~ I(preds_tc_cg$predictor*100), lwd = 2, lty = 2, col = "#1b9e77")
points(I(preds_tc_cg$predictor[c(1,200)]*100), inv.as(preds_tc_cg$predictions[c(1,200)]), pch = 21, col = "#1b9e77", bg = "#1b9e77")
lines(inv.as(preds_tc_pg$predictions) ~ I(preds_tc_cg$predictor*100), lwd = 2, lty = 2, col = "#000000")
points(I(preds_tc_cg$predictor[c(1,200)]*100), inv.as(preds_tc_pg$predictions[c(1,200)]), pch = 22, col = "#000000", bg = "#000000")
lines(inv.as(preds_tc_pf$predictions) ~ I(preds_tc_cg$predictor*100), lwd = 2, lty = 1, col = "#E69F00")
points(I(preds_tc_cg$predictor[c(1,200)]*100), inv.as(preds_tc_pf$predictions[c(1,200)]), pch = 23, col = "#E69F00", bg = "#E69F00")
lines(inv.as(preds_tc_sh$predictions) ~ I(preds_tc_cg$predictor*100), lwd = 2, lty = 1, col = "#56B4E9")
points(I(preds_tc_cg$predictor[c(1,200)]*100), inv.as(preds_tc_sh$predictions[c(1,200)]), pch = 24, col = "#56B4E9", bg = "#56B4E9")
axis(side = 1)
axis(side = 2, at = axTicks(2), labels = axTicks(2)*100)
mtext(text = "Tree cover (%)", side = 1, line = 2.2)
mtext(text = "Understory cover (%)", side = 2, outer = TRUE, line = 2, cex = 1)
mtext(text = "(a)", side = 1, line = -10, adj = 0.05)
plot(NA,
ylim = c(0,.1),
xlim = c(min(plot_data$AWC), max(plot_data$AWC)),
xlab = "",
ylab = "",
bg='grey60',
col = 'grey30',
pch = 21,
cex.lab = 1.5,
bty = 'n',
xaxt = 'n',
yaxt = 'n')
lines(inv.as(preds_awc_cg$predictions) ~ I(preds_awc_cg$predictor), lwd = 2, lty = 2, col = "#1b9e77")
points(I(preds_awc_cg$predictor[c(1,200)]), inv.as(preds_awc_cg$predictions[c(1,200)]), pch = 21, col = "#1b9e77", bg = "#1b9e77")
lines(inv.as(preds_awc_pg$predictions) ~ I(preds_awc_cg$predictor), lwd = 2, lty = 2, col = "#000000")
points(I(preds_awc_cg$predictor[c(1,200)]), inv.as(preds_awc_pg$predictions[c(1,200)]), pch = 22, col = "#000000", bg = "#000000")
lines(inv.as(preds_awc_pf$predictions) ~ I(preds_awc_cg$predictor), lwd = 2, lty = 1, col = "#E69F00")
points(I(preds_awc_cg$predictor[c(1,200)]), inv.as(preds_awc_pf$predictions[c(1,200)]), pch = 23, col = "#E69F00", bg = "#E69F00")
lines(inv.as(preds_awc_sh$predictions) ~ I(preds_awc_cg$predictor), lwd = 2, lty = 2, col = "#56B4E9")
points(I(preds_awc_cg$predictor[c(1,200)]), inv.as(preds_awc_sh$predictions[c(1,200)]), pch = 24, col = "#56B4E9", bg = "#56B4E9")
axis(side = 1)
axis(side = 2, at = axTicks(2), labels = axTicks(2)*100)
mtext(text = "Soil AWC (%)", side = 1, line = 2.2)
mtext(text = "(b)", side = 1, line = -10, adj = 0.05)
plot.new()
legend("topright", legend = c("Cheatgrass", "Per. Grass", "Per. Forb", "Shrub"),
lty = 1, pch = c(21,22,23,24), lwd = 2, cex = 1.3, col = c("#1b9e77", "#000000", "#E69F00", "#56B4E9"),
pt.bg = c("#1b9e77", "#000000", "#E69F00", "#56B4E9"))
plot(NA,
ylim = c(0,.25),
xlim = c(min(plot_data$Delta_pdc), max(plot_data$Delta_pdc)),
xlab = "",
ylab = "",
bg='grey60',
col = 'grey30',
pch = 21,
cex.lab = 1.5,
bty = 'n',
xaxt = 'n',
yaxt = 'n')
lines(inv.as(preds_pdc_10_cg$predictions) ~ I(preds_pdc_10_cg$predictor), lwd = 2, lty = 1, col = "#1b9e77")
points(I(preds_pdc_10_cg$predictor[c(1,200)]), inv.as(preds_pdc_10_cg$predictions[c(1,200)]), pch = 21, col = "#1b9e77", bg = "#1b9e77")
lines(inv.as(preds_pdc_10_pg$predictions) ~ I(preds_pdc_10_cg$predictor), lwd = 2, lty = 1, col = "#000000")
points(I(preds_pdc_10_cg$predictor[c(1,200)]), inv.as(preds_pdc_10_pg$predictions[c(1,200)]), pch = 22, col = "#000000", bg = "#000000")
lines(inv.as(preds_pdc_10_pf$predictions) ~ I(preds_pdc_10_cg$predictor), lwd = 2, lty = 2, col = "#E69F00")
points(I(preds_pdc_10_cg$predictor[c(1,200)]), inv.as(preds_pdc_10_pf$predictions[c(1,200)]), pch = 23, col = "#E69F00", bg = "#E69F00")
lines(inv.as(preds_pdc_10_sh$predictions) ~ I(preds_pdc_10_cg$predictor), lwd = 2, lty = 2, col = "#56B4E9")
points(I(preds_pdc_10_cg$predictor[c(1,200)]), inv.as(preds_pdc_10_sh$predictions[c(1,200)]), pch = 24, col = "#56B4E9", bg = "#56B4E9")
axis(side = 1)
axis(side = 2, at = axTicks(2), labels = axTicks(2)*100)
text(x = -30, y = .18, labels = "10% CWD", cex = 1.3)
mtext(text = "(c)", side = 1, line = -10, adj = 0.05)
plot(NA,
ylim = c(0,.25),
xlim = c(min(plot_data$Delta_pdc), max(plot_data$Delta_pdc)),
xlab = "",
ylab = "",
bg='grey60',
col = 'grey30',
pch = 21,
cex.lab = 1.5,
bty = 'n',
xaxt = 'n',
yaxt = 'n')
lines(inv.as(preds_pdc_50_cg$predictions) ~ I(preds_pdc_90_cg$predictor), lwd = 2, lty = 1, col = "#1b9e77")
points(I(preds_pdc_90_cg$predictor[c(1,200)]), inv.as(preds_pdc_50_cg$predictions[c(1,200)]), pch = 21, col = "#1b9e77", bg = "#1b9e77")
lines(inv.as(preds_pdc_50_pg$predictions) ~ I(preds_pdc_90_cg$predictor), lwd = 2, lty = 1, col = "#000000")
points(I(preds_pdc_50_cg$predictor[c(1,200)]), inv.as(preds_pdc_50_pg$predictions[c(1,200)]), pch = 22, col = "#000000", bg = "#000000")
lines(inv.as(preds_pdc_50_pf$predictions) ~ I(preds_pdc_90_cg$predictor), lwd = 2, lty = 2, col = "#E69F00")
points(I(preds_pdc_50_cg$predictor[c(1,200)]), inv.as(preds_pdc_50_pf$predictions[c(1,200)]), pch = 23, col = "#E69F00", bg = "#E69F00")
lines(inv.as(preds_pdc_50_sh$predictions) ~ I(preds_pdc_90_cg$predictor), lwd = 2, lty = 2, col = "#56B4E9")
points(I(preds_pdc_50_cg$predictor[c(1,200)]), inv.as(preds_pdc_50_sh$predictions[c(1,200)]), pch = 24, col = "#56B4E9", bg = "#56B4E9")
axis(side = 1)
axis(side = 2, at = axTicks(2), labels = axTicks(2)*100)
text(x = -30, y = .18, labels = "50% CWD", cex = 1.3)
mtext(text = "Mean change in live canopy (%)", side = 1, line = 2.2)
mtext(text = "(d)", side = 1, line = -10, adj = 0.05)
plot(NA,
ylim = c(0,.25),
xlim = c(min(plot_data$Delta_pdc), max(plot_data$Delta_pdc)),
xlab = "",
ylab = "",
bg='grey60',
col = 'grey30',
pch = 21,
cex.lab = 1.5,
bty = 'n',
xaxt = 'n',
yaxt = 'n')
lines(inv.as(preds_pdc_90_cg$predictions) ~ I(preds_pdc_90_cg$predictor), lwd = 2, lty = 1, col = "#1b9e77")
points(I(preds_pdc_90_cg$predictor[c(1,200)]), inv.as(preds_pdc_90_cg$predictions[c(1,200)]), pch = 21, col = "#1b9e77", bg = "#1b9e77")
lines(inv.as(preds_pdc_90_pg$predictions) ~ I(preds_pdc_90_cg$predictor), lwd = 2, lty = 1, col = "#000000")
points(I(preds_pdc_90_cg$predictor[c(1,200)]), inv.as(preds_pdc_90_pg$predictions[c(1,200)]), pch = 22, col = "#000000", bg = "#000000")
lines(inv.as(preds_pdc_90_pf$predictions) ~ I(preds_pdc_90_cg$predictor), lwd = 2, lty = 2, col = "#E69F00")
points(I(preds_pdc_90_cg$predictor[c(1,200)]), inv.as(preds_pdc_90_pf$predictions[c(1,200)]), pch = 23, col = "#E69F00", bg = "#E69F00")
lines(inv.as(preds_pdc_90_sh$predictions) ~ I(preds_pdc_90_cg$predictor), lwd = 2, lty = 2, col = "#56B4E9")
points(I(preds_pdc_90_cg$predictor[c(1,200)]), inv.as(preds_pdc_90_sh$predictions[c(1,200)]), pch = 24, col = "#56B4E9", bg = "#56B4E9")
axis(side = 1)
axis(side = 2, at = axTicks(2), labels = axTicks(2)*100)
text(x = -30, y = .18, labels = "90% CWD", cex = 1.3)
mtext(text = "(e)", side = 1, line = -10, adj = 0.05)
dev.off()
par(pardefault)
####################################################################
## Multipanel figure to compare between functional types
# Figure 5
####################################################################
# for unscaling variables -- these things come from a full model in the model set, you'll have to change
# the number or the path depending upon what kind of model object and the order of your models, etc.
# You can also just get them from the raw data.
tc_mean <- mean(plot_data$Tree_cover)
tc_sd <- sd(plot_data$Tree_cover)
cwd_mean <-  mean(plot_data$cwd_normal_cum)
cwd_sd <- sd(plot_data$cwd_normal_cum)
Delta_pdc_mean <-  mean(plot_data$Delta_pdc)
Delta_pdc_sd <- sd(plot_data$Delta_pdc)
#--------------------------------------------------------------------------
## Calcuate partial residuals, effects
#--------------------------------------------------------------------------
C_tc <- data.frame(
Tree_cover = seq(min(plot_data$Tree_cover), max(plot_data$Tree_cover), length.out = 200),
cwd_normal_cum = mean(plot_data$cwd_normal_cum),
Delta_pdc = mean(plot_data$Delta_pdc),
AWC = mean(plot_data$AWC)
)
C_awc <- data.frame(
Tree_cover = mean(plot_data$Tree_cover),
cwd_normal_cum = mean(plot_data$cwd_normal_cum),
Delta_pdc = mean(plot_data$Delta_pdc),
AWC = seq(min(plot_data$AWC), max(plot_data$AWC), length.out = 200)
)
C_pdc_10 <- data.frame(
Tree_cover = mean(plot_data$Tree_cover),
cwd_normal_cum = unname(quantile(plot_data$cwd_normal_cum, .1)),
Delta_pdc = seq(min(plot_data$Delta_pdc), max(plot_data$Delta_pdc), length.out = 200),
AWC = mean(plot_data$AWC)
)
C_pdc_50 <- data.frame(
Tree_cover = mean(plot_data$Tree_cover),
cwd_normal_cum = unname(quantile(plot_data$cwd_normal_cum, .5)),
Delta_pdc = seq(min(plot_data$Delta_pdc), max(plot_data$Delta_pdc), length.out = 200),
AWC = mean(plot_data$AWC)
)
C_pdc_90 <- data.frame(
Tree_cover = mean(plot_data$Tree_cover),
cwd_normal_cum = unname(quantile(plot_data$cwd_normal_cum, .9)),
Delta_pdc = seq(min(plot_data$Delta_pdc), max(plot_data$Delta_pdc), length.out = 200),
AWC = mean(plot_data$AWC)
)
# model <- cg
# C <- C_tc
# predictor <- "Tree_cover"
calculate_preds <- function(model, C, predictor){
preds <- data.frame(
predictions = predict(model, re.form = NA, newdata = C, type = "response"),
predictor = C[, predictor]
)
return(preds)
}
# Use the function to get all the stuff we need
# (predictions, partial residuals, and SEs)
# this is the dumbest way to do this but I don't want to refactor it
preds_tc_cg <- calculate_preds(cg, C_tc, "Tree_cover")
preds_tc_pg <- calculate_preds(pg, C_tc, "Tree_cover")
preds_tc_pf <- calculate_preds(pf, C_tc, "Tree_cover")
preds_tc_sh <- calculate_preds(sh, C_tc, "Tree_cover")
preds_awc_cg <- calculate_preds(cg, C_awc, "AWC")
preds_awc_pg <- calculate_preds(pg, C_awc, "AWC")
preds_awc_pf <- calculate_preds(pf, C_awc, "AWC")
preds_awc_sh <- calculate_preds(sh, C_awc, "AWC")
preds_pdc_10_cg <- calculate_preds(cg, C_pdc_10, "Delta_pdc")
preds_pdc_10_pg <- calculate_preds(pg, C_pdc_10, "Delta_pdc")
preds_pdc_10_pf <- calculate_preds(pf, C_pdc_10, "Delta_pdc")
preds_pdc_10_sh <- calculate_preds(sh, C_pdc_10, "Delta_pdc")
preds_pdc_50_cg <- calculate_preds(cg, C_pdc_50, "Delta_pdc")
preds_pdc_50_pg <- calculate_preds(pg, C_pdc_50, "Delta_pdc")
preds_pdc_50_pf <- calculate_preds(pf, C_pdc_50, "Delta_pdc")
preds_pdc_50_sh <- calculate_preds(sh, C_pdc_50, "Delta_pdc")
preds_pdc_90_cg <- calculate_preds(cg, C_pdc_90, "Delta_pdc")
preds_pdc_90_pg <- calculate_preds(pg, C_pdc_90, "Delta_pdc")
preds_pdc_90_pf <- calculate_preds(pf, C_pdc_90, "Delta_pdc")
preds_pdc_90_sh <- calculate_preds(sh, C_pdc_90, "Delta_pdc")
opar <- par(no.readonly = TRUE)
par(opar)
tiff(filename="./outputs/Figure_5_understory_effects.tiff",
type="cairo",
units="in",
width = 7,
height=5,
pointsize=15,
compression = "lzw",
res=600)
layout(matrix(c(1,2,3,4,5,6), nrow = 2, ncol = 3, byrow = TRUE))
par(oma = c(2,4,0,0), mar = c(3,1,1,1), bty = 'n')
plot(NA,
ylim = c(0,.12),
xlim = c(I(min(plot_data$Tree_cover)*100), I(max(plot_data$Tree_cover)*100)),
xlab = "",
ylab = "",
bg='grey60',
col = 'grey30',
pch = 21,
cex.lab = 1.5,
bty = 'n',
xaxt = 'n',
yaxt = 'n')
lines(inv.as(preds_tc_cg$predictions) ~ I(preds_tc_cg$predictor*100), lwd = 2, lty = 2, col = "#1b9e77")
points(I(preds_tc_cg$predictor[c(1,200)]*100), inv.as(preds_tc_cg$predictions[c(1,200)]), pch = 21, col = "#1b9e77", bg = "#1b9e77")
lines(inv.as(preds_tc_pg$predictions) ~ I(preds_tc_cg$predictor*100), lwd = 2, lty = 2, col = "#000000")
points(I(preds_tc_cg$predictor[c(1,200)]*100), inv.as(preds_tc_pg$predictions[c(1,200)]), pch = 22, col = "#000000", bg = "#000000")
lines(inv.as(preds_tc_pf$predictions) ~ I(preds_tc_cg$predictor*100), lwd = 2, lty = 1, col = "#E69F00")
points(I(preds_tc_cg$predictor[c(1,200)]*100), inv.as(preds_tc_pf$predictions[c(1,200)]), pch = 23, col = "#E69F00", bg = "#E69F00")
lines(inv.as(preds_tc_sh$predictions) ~ I(preds_tc_cg$predictor*100), lwd = 2, lty = 1, col = "#56B4E9")
points(I(preds_tc_cg$predictor[c(1,200)]*100), inv.as(preds_tc_sh$predictions[c(1,200)]), pch = 24, col = "#56B4E9", bg = "#56B4E9")
axis(side = 1)
axis(side = 2, at = axTicks(2), labels = axTicks(2)*100)
mtext(text = "Tree cover (%)", side = 1, line = 2.2)
mtext(text = "Understory cover (%)", side = 2, outer = TRUE, line = 2, cex = 1)
mtext(text = "(a)", side = 1, line = -10, adj = 0.05)
plot(NA,
ylim = c(0,.1),
xlim = c(min(plot_data$AWC), max(plot_data$AWC)),
xlab = "",
ylab = "",
bg='grey60',
col = 'grey30',
pch = 21,
cex.lab = 1.5,
bty = 'n',
xaxt = 'n',
yaxt = 'n')
lines(inv.as(preds_awc_cg$predictions) ~ I(preds_awc_cg$predictor), lwd = 2, lty = 2, col = "#1b9e77")
points(I(preds_awc_cg$predictor[c(1,200)]), inv.as(preds_awc_cg$predictions[c(1,200)]), pch = 21, col = "#1b9e77", bg = "#1b9e77")
lines(inv.as(preds_awc_pg$predictions) ~ I(preds_awc_cg$predictor), lwd = 2, lty = 2, col = "#000000")
points(I(preds_awc_cg$predictor[c(1,200)]), inv.as(preds_awc_pg$predictions[c(1,200)]), pch = 22, col = "#000000", bg = "#000000")
lines(inv.as(preds_awc_pf$predictions) ~ I(preds_awc_cg$predictor), lwd = 2, lty = 1, col = "#E69F00")
points(I(preds_awc_cg$predictor[c(1,200)]), inv.as(preds_awc_pf$predictions[c(1,200)]), pch = 23, col = "#E69F00", bg = "#E69F00")
lines(inv.as(preds_awc_sh$predictions) ~ I(preds_awc_cg$predictor), lwd = 2, lty = 2, col = "#56B4E9")
points(I(preds_awc_cg$predictor[c(1,200)]), inv.as(preds_awc_sh$predictions[c(1,200)]), pch = 24, col = "#56B4E9", bg = "#56B4E9")
axis(side = 1)
axis(side = 2, at = axTicks(2), labels = axTicks(2)*100)
mtext(text = "Soil AWC (%)", side = 1, line = 2.2)
mtext(text = "(b)", side = 1, line = -10, adj = 0.05)
plot.new()
legend("topright", legend = c("Cheatgrass", "Per. Grass", "Per. Forb", "Shrub"),
lty = 1, pch = c(21,22,23,24), lwd = 2, cex = 1.3, col = c("#1b9e77", "#000000", "#E69F00", "#56B4E9"),
pt.bg = c("#1b9e77", "#000000", "#E69F00", "#56B4E9"))
plot(NA,
ylim = c(0,.25),
xlim = c(min(plot_data$Delta_pdc), max(plot_data$Delta_pdc)),
xlab = "",
ylab = "",
bg='grey60',
col = 'grey30',
pch = 21,
cex.lab = 1.5,
bty = 'n',
xaxt = 'n',
yaxt = 'n')
lines(inv.as(preds_pdc_10_cg$predictions) ~ I(preds_pdc_10_cg$predictor), lwd = 2, lty = 1, col = "#1b9e77")
points(I(preds_pdc_10_cg$predictor[c(1,200)]), inv.as(preds_pdc_10_cg$predictions[c(1,200)]), pch = 21, col = "#1b9e77", bg = "#1b9e77")
lines(inv.as(preds_pdc_10_pg$predictions) ~ I(preds_pdc_10_cg$predictor), lwd = 2, lty = 1, col = "#000000")
points(I(preds_pdc_10_cg$predictor[c(1,200)]), inv.as(preds_pdc_10_pg$predictions[c(1,200)]), pch = 22, col = "#000000", bg = "#000000")
lines(inv.as(preds_pdc_10_pf$predictions) ~ I(preds_pdc_10_cg$predictor), lwd = 2, lty = 2, col = "#E69F00")
points(I(preds_pdc_10_cg$predictor[c(1,200)]), inv.as(preds_pdc_10_pf$predictions[c(1,200)]), pch = 23, col = "#E69F00", bg = "#E69F00")
lines(inv.as(preds_pdc_10_sh$predictions) ~ I(preds_pdc_10_cg$predictor), lwd = 2, lty = 1, col = "#56B4E9")
points(I(preds_pdc_10_cg$predictor[c(1,200)]), inv.as(preds_pdc_10_sh$predictions[c(1,200)]), pch = 24, col = "#56B4E9", bg = "#56B4E9")
axis(side = 1)
axis(side = 2, at = axTicks(2), labels = axTicks(2)*100)
text(x = -30, y = .18, labels = "10% CWD", cex = 1.3)
mtext(text = "(c)", side = 1, line = -10, adj = 0.05)
plot(NA,
ylim = c(0,.25),
xlim = c(min(plot_data$Delta_pdc), max(plot_data$Delta_pdc)),
xlab = "",
ylab = "",
bg='grey60',
col = 'grey30',
pch = 21,
cex.lab = 1.5,
bty = 'n',
xaxt = 'n',
yaxt = 'n')
lines(inv.as(preds_pdc_50_cg$predictions) ~ I(preds_pdc_90_cg$predictor), lwd = 2, lty = 1, col = "#1b9e77")
points(I(preds_pdc_90_cg$predictor[c(1,200)]), inv.as(preds_pdc_50_cg$predictions[c(1,200)]), pch = 21, col = "#1b9e77", bg = "#1b9e77")
lines(inv.as(preds_pdc_50_pg$predictions) ~ I(preds_pdc_90_cg$predictor), lwd = 2, lty = 1, col = "#000000")
points(I(preds_pdc_50_cg$predictor[c(1,200)]), inv.as(preds_pdc_50_pg$predictions[c(1,200)]), pch = 22, col = "#000000", bg = "#000000")
lines(inv.as(preds_pdc_50_pf$predictions) ~ I(preds_pdc_90_cg$predictor), lwd = 2, lty = 2, col = "#E69F00")
points(I(preds_pdc_50_cg$predictor[c(1,200)]), inv.as(preds_pdc_50_pf$predictions[c(1,200)]), pch = 23, col = "#E69F00", bg = "#E69F00")
lines(inv.as(preds_pdc_50_sh$predictions) ~ I(preds_pdc_90_cg$predictor), lwd = 2, lty = 1, col = "#56B4E9")
points(I(preds_pdc_50_cg$predictor[c(1,200)]), inv.as(preds_pdc_50_sh$predictions[c(1,200)]), pch = 24, col = "#56B4E9", bg = "#56B4E9")
axis(side = 1)
axis(side = 2, at = axTicks(2), labels = axTicks(2)*100)
text(x = -30, y = .18, labels = "50% CWD", cex = 1.3)
mtext(text = "Mean change in live canopy (%)", side = 1, line = 2.2)
mtext(text = "(d)", side = 1, line = -10, adj = 0.05)
plot(NA,
ylim = c(0,.25),
xlim = c(min(plot_data$Delta_pdc), max(plot_data$Delta_pdc)),
xlab = "",
ylab = "",
bg='grey60',
col = 'grey30',
pch = 21,
cex.lab = 1.5,
bty = 'n',
xaxt = 'n',
yaxt = 'n')
lines(inv.as(preds_pdc_90_cg$predictions) ~ I(preds_pdc_90_cg$predictor), lwd = 2, lty = 1, col = "#1b9e77")
points(I(preds_pdc_90_cg$predictor[c(1,200)]), inv.as(preds_pdc_90_cg$predictions[c(1,200)]), pch = 21, col = "#1b9e77", bg = "#1b9e77")
lines(inv.as(preds_pdc_90_pg$predictions) ~ I(preds_pdc_90_cg$predictor), lwd = 2, lty = 1, col = "#000000")
points(I(preds_pdc_90_cg$predictor[c(1,200)]), inv.as(preds_pdc_90_pg$predictions[c(1,200)]), pch = 22, col = "#000000", bg = "#000000")
lines(inv.as(preds_pdc_90_pf$predictions) ~ I(preds_pdc_90_cg$predictor), lwd = 2, lty = 2, col = "#E69F00")
points(I(preds_pdc_90_cg$predictor[c(1,200)]), inv.as(preds_pdc_90_pf$predictions[c(1,200)]), pch = 23, col = "#E69F00", bg = "#E69F00")
lines(inv.as(preds_pdc_90_sh$predictions) ~ I(preds_pdc_90_cg$predictor), lwd = 2, lty = 1, col = "#56B4E9")
points(I(preds_pdc_90_cg$predictor[c(1,200)]), inv.as(preds_pdc_90_sh$predictions[c(1,200)]), pch = 24, col = "#56B4E9", bg = "#56B4E9")
axis(side = 1)
axis(side = 2, at = axTicks(2), labels = axTicks(2)*100)
text(x = -30, y = .18, labels = "90% CWD", cex = 1.3)
mtext(text = "(e)", side = 1, line = -10, adj = 0.05)
dev.off()
par(pardefault)
cheatgrass_plot <- lmer(asin(sqrt(Cheatgrass/100)) ~ scale(Tree_cover) + scale(Delta_pdc)*scale(cwd_normal_cum) +
scale(AWC) + (1|Cluster), data = plot_data)
summary(cheatgrass_plot, ddf = "Kenward-Roger")
cheatgrass_plot <- lmer(((Cheatgrass/100)) ~ scale(Tree_cover) + scale(Delta_pdc)*scale(cwd_normal_cum) +
scale(AWC) + (1|Cluster), data = plot_data)
summary(cheatgrass_plot, ddf = "Kenward-Roger")
plot(allEffects(cheatgrass_plot, partial.residuals = TRUE))
cheatgrass_plot <- lmer(asin(sqrt(Cheatgrass/100)) ~ scale(Tree_cover) + scale(Delta_pdc)*scale(cwd_normal_cum) +
scale(AWC) + (1|Cluster), data = plot_data)
plot(allEffects(cheatgrass_plot, partial.residuals = TRUE))
tiff(filename="./outputs/Figure_5_understory_effects.tiff",
type="cairo",
units="in",
width = 7,
height=5,
pointsize=15,
compression = "lzw",
res=600)
layout(matrix(c(1,2,3,4,5,6), nrow = 2, ncol = 3, byrow = TRUE))
par(oma = c(2,4,0,0), mar = c(3,1,1,1), bty = 'n')
plot(NA,
ylim = c(0,.12),
xlim = c(I(min(plot_data$Tree_cover)*100), I(max(plot_data$Tree_cover)*100)),
xlab = "",
ylab = "",
bg='grey60',
col = 'grey30',
pch = 21,
cex.lab = 1.5,
bty = 'n',
xaxt = 'n',
yaxt = 'n')
lines(inv.as(preds_tc_cg$predictions) ~ I(preds_tc_cg$predictor*100), lwd = 2, lty = 2, col = "#1b9e77")
points(I(preds_tc_cg$predictor[c(1,200)]*100), inv.as(preds_tc_cg$predictions[c(1,200)]), pch = 21, col = "#1b9e77", bg = "#1b9e77")
lines(inv.as(preds_tc_pg$predictions) ~ I(preds_tc_cg$predictor*100), lwd = 2, lty = 2, col = "#000000")
points(I(preds_tc_cg$predictor[c(1,200)]*100), inv.as(preds_tc_pg$predictions[c(1,200)]), pch = 22, col = "#000000", bg = "#000000")
lines(inv.as(preds_tc_pf$predictions) ~ I(preds_tc_cg$predictor*100), lwd = 2, lty = 1, col = "#E69F00")
points(I(preds_tc_cg$predictor[c(1,200)]*100), inv.as(preds_tc_pf$predictions[c(1,200)]), pch = 23, col = "#E69F00", bg = "#E69F00")
lines(inv.as(preds_tc_sh$predictions) ~ I(preds_tc_cg$predictor*100), lwd = 2, lty = 1, col = "#56B4E9")
points(I(preds_tc_cg$predictor[c(1,200)]*100), inv.as(preds_tc_sh$predictions[c(1,200)]), pch = 24, col = "#56B4E9", bg = "#56B4E9")
axis(side = 1)
axis(side = 2, at = axTicks(2), labels = axTicks(2)*100)
mtext(text = "Tree cover (%)", side = 1, line = 2.2)
mtext(text = "Understory cover (%)", side = 2, outer = TRUE, line = 2, cex = 1)
mtext(text = "(a)", side = 1, line = -10, adj = 0.05)
plot(NA,
ylim = c(0,.1),
xlim = c(min(plot_data$AWC), max(plot_data$AWC)),
xlab = "",
ylab = "",
bg='grey60',
col = 'grey30',
pch = 21,
cex.lab = 1.5,
bty = 'n',
xaxt = 'n',
yaxt = 'n')
lines(inv.as(preds_awc_cg$predictions) ~ I(preds_awc_cg$predictor), lwd = 2, lty = 1, col = "#1b9e77")
points(I(preds_awc_cg$predictor[c(1,200)]), inv.as(preds_awc_cg$predictions[c(1,200)]), pch = 21, col = "#1b9e77", bg = "#1b9e77")
lines(inv.as(preds_awc_pg$predictions) ~ I(preds_awc_cg$predictor), lwd = 2, lty = 2, col = "#000000")
points(I(preds_awc_cg$predictor[c(1,200)]), inv.as(preds_awc_pg$predictions[c(1,200)]), pch = 22, col = "#000000", bg = "#000000")
lines(inv.as(preds_awc_pf$predictions) ~ I(preds_awc_cg$predictor), lwd = 2, lty = 2, col = "#E69F00")
points(I(preds_awc_cg$predictor[c(1,200)]), inv.as(preds_awc_pf$predictions[c(1,200)]), pch = 23, col = "#E69F00", bg = "#E69F00")
lines(inv.as(preds_awc_sh$predictions) ~ I(preds_awc_cg$predictor), lwd = 2, lty = 2, col = "#56B4E9")
points(I(preds_awc_cg$predictor[c(1,200)]), inv.as(preds_awc_sh$predictions[c(1,200)]), pch = 24, col = "#56B4E9", bg = "#56B4E9")
axis(side = 1)
axis(side = 2, at = axTicks(2), labels = axTicks(2)*100)
mtext(text = "Soil AWC (%)", side = 1, line = 2.2)
mtext(text = "(b)", side = 1, line = -10, adj = 0.05)
plot.new()
legend("topright", legend = c("Cheatgrass", "Per. Grass", "Per. Forb", "Shrub"),
lty = 1, pch = c(21,22,23,24), lwd = 2, cex = 1.3, col = c("#1b9e77", "#000000", "#E69F00", "#56B4E9"),
pt.bg = c("#1b9e77", "#000000", "#E69F00", "#56B4E9"))
plot(NA,
ylim = c(0,.25),
xlim = c(min(plot_data$Delta_pdc), max(plot_data$Delta_pdc)),
xlab = "",
ylab = "",
bg='grey60',
col = 'grey30',
pch = 21,
cex.lab = 1.5,
bty = 'n',
xaxt = 'n',
yaxt = 'n')
lines(inv.as(preds_pdc_10_cg$predictions) ~ I(preds_pdc_10_cg$predictor), lwd = 2, lty = 1, col = "#1b9e77")
points(I(preds_pdc_10_cg$predictor[c(1,200)]), inv.as(preds_pdc_10_cg$predictions[c(1,200)]), pch = 21, col = "#1b9e77", bg = "#1b9e77")
lines(inv.as(preds_pdc_10_pg$predictions) ~ I(preds_pdc_10_cg$predictor), lwd = 2, lty = 1, col = "#000000")
points(I(preds_pdc_10_cg$predictor[c(1,200)]), inv.as(preds_pdc_10_pg$predictions[c(1,200)]), pch = 22, col = "#000000", bg = "#000000")
lines(inv.as(preds_pdc_10_pf$predictions) ~ I(preds_pdc_10_cg$predictor), lwd = 2, lty = 2, col = "#E69F00")
points(I(preds_pdc_10_cg$predictor[c(1,200)]), inv.as(preds_pdc_10_pf$predictions[c(1,200)]), pch = 23, col = "#E69F00", bg = "#E69F00")
lines(inv.as(preds_pdc_10_sh$predictions) ~ I(preds_pdc_10_cg$predictor), lwd = 2, lty = 1, col = "#56B4E9")
points(I(preds_pdc_10_cg$predictor[c(1,200)]), inv.as(preds_pdc_10_sh$predictions[c(1,200)]), pch = 24, col = "#56B4E9", bg = "#56B4E9")
axis(side = 1)
axis(side = 2, at = axTicks(2), labels = axTicks(2)*100)
text(x = -30, y = .18, labels = "10% CWD", cex = 1.3)
mtext(text = "(c)", side = 1, line = -10, adj = 0.05)
plot(NA,
ylim = c(0,.25),
xlim = c(min(plot_data$Delta_pdc), max(plot_data$Delta_pdc)),
xlab = "",
ylab = "",
bg='grey60',
col = 'grey30',
pch = 21,
cex.lab = 1.5,
bty = 'n',
xaxt = 'n',
yaxt = 'n')
lines(inv.as(preds_pdc_50_cg$predictions) ~ I(preds_pdc_90_cg$predictor), lwd = 2, lty = 1, col = "#1b9e77")
points(I(preds_pdc_90_cg$predictor[c(1,200)]), inv.as(preds_pdc_50_cg$predictions[c(1,200)]), pch = 21, col = "#1b9e77", bg = "#1b9e77")
lines(inv.as(preds_pdc_50_pg$predictions) ~ I(preds_pdc_90_cg$predictor), lwd = 2, lty = 1, col = "#000000")
points(I(preds_pdc_50_cg$predictor[c(1,200)]), inv.as(preds_pdc_50_pg$predictions[c(1,200)]), pch = 22, col = "#000000", bg = "#000000")
lines(inv.as(preds_pdc_50_pf$predictions) ~ I(preds_pdc_90_cg$predictor), lwd = 2, lty = 2, col = "#E69F00")
points(I(preds_pdc_50_cg$predictor[c(1,200)]), inv.as(preds_pdc_50_pf$predictions[c(1,200)]), pch = 23, col = "#E69F00", bg = "#E69F00")
lines(inv.as(preds_pdc_50_sh$predictions) ~ I(preds_pdc_90_cg$predictor), lwd = 2, lty = 1, col = "#56B4E9")
points(I(preds_pdc_50_cg$predictor[c(1,200)]), inv.as(preds_pdc_50_sh$predictions[c(1,200)]), pch = 24, col = "#56B4E9", bg = "#56B4E9")
axis(side = 1)
axis(side = 2, at = axTicks(2), labels = axTicks(2)*100)
text(x = -30, y = .18, labels = "50% CWD", cex = 1.3)
mtext(text = "Mean change in live canopy (%)", side = 1, line = 2.2)
mtext(text = "(d)", side = 1, line = -10, adj = 0.05)
plot(NA,
ylim = c(0,.25),
xlim = c(min(plot_data$Delta_pdc), max(plot_data$Delta_pdc)),
xlab = "",
ylab = "",
bg='grey60',
col = 'grey30',
pch = 21,
cex.lab = 1.5,
bty = 'n',
xaxt = 'n',
yaxt = 'n')
lines(inv.as(preds_pdc_90_cg$predictions) ~ I(preds_pdc_90_cg$predictor), lwd = 2, lty = 1, col = "#1b9e77")
points(I(preds_pdc_90_cg$predictor[c(1,200)]), inv.as(preds_pdc_90_cg$predictions[c(1,200)]), pch = 21, col = "#1b9e77", bg = "#1b9e77")
lines(inv.as(preds_pdc_90_pg$predictions) ~ I(preds_pdc_90_cg$predictor), lwd = 2, lty = 1, col = "#000000")
points(I(preds_pdc_90_cg$predictor[c(1,200)]), inv.as(preds_pdc_90_pg$predictions[c(1,200)]), pch = 22, col = "#000000", bg = "#000000")
lines(inv.as(preds_pdc_90_pf$predictions) ~ I(preds_pdc_90_cg$predictor), lwd = 2, lty = 2, col = "#E69F00")
points(I(preds_pdc_90_cg$predictor[c(1,200)]), inv.as(preds_pdc_90_pf$predictions[c(1,200)]), pch = 23, col = "#E69F00", bg = "#E69F00")
lines(inv.as(preds_pdc_90_sh$predictions) ~ I(preds_pdc_90_cg$predictor), lwd = 2, lty = 1, col = "#56B4E9")
points(I(preds_pdc_90_cg$predictor[c(1,200)]), inv.as(preds_pdc_90_sh$predictions[c(1,200)]), pch = 24, col = "#56B4E9", bg = "#56B4E9")
axis(side = 1)
axis(side = 2, at = axTicks(2), labels = axTicks(2)*100)
text(x = -30, y = .18, labels = "90% CWD", cex = 1.3)
mtext(text = "(e)", side = 1, line = -10, adj = 0.05)
dev.off()
cheatgrass_plot <- lmer(asin(sqrt(Cheatgrass/100)) ~ scale(Tree_cover) + scale(Delta_pdc)*scale(cwd_normal_cum) +
scale(AWC) + (1|Cluster), data = plot_data)
summary(cheatgrass_plot, ddf = "Kenward-Roger")
cheatgrass_plot <- lmer(asin(sqrt(Cheatgrass/100)) ~ scale(Tree_cover) + scale(Delta_pdc)+scale(cwd_normal_cum) +
scale(AWC) + (1|Cluster), data = plot_data)
summary(cheatgrass_plot, ddf = "Kenward-Roger")
plot(allEffects(cheatgrass_plot, partial.residuals = TRUE))
