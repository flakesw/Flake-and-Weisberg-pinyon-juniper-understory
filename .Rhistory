mtext(side = 1, text = "Change in live canopy (%)", outer = TRUE, line = 2.6)
mtext(side = 2, text = "Change in cheatgrass cover (%)", outer = TRUE, line = 2.3)
dev.off()
## new data
model <- cg_change_lm
model2 <- cg_change_lm_no_outliers
# model <- model2
compare$delta_cg <- compare$Cheatgrass - compare$Cheatgrass.Cover
# compare2 <- compare[-c(5, 10), ]
#create dataframe of new data to calculate predictions and envelope
C_cg_change_10 <- data.frame(
cwd_normal_cum = unname(quantile(compare$cwd_normal_cum, .15)),
Delta_tc = seq(-50,10, length.out = 200)
)
C_cg_change_50 <- data.frame(
cwd_normal_cum = unname(quantile(compare$cwd_normal_cum, .5)),
Delta_tc = seq(-50,10, length.out = 200)
)
C_cg_change_90 <- data.frame(
cwd_normal_cum = unname(quantile(compare$cwd_normal_cum, .85)),
Delta_tc = seq(-50,10, length.out = 200)
)
C_cg <- list(C_cg_change_10, C_cg_change_50, C_cg_change_90)
#function to calculate predictions and envelope
preds_cg_change <- function(model, C, predictor){
preds <- data.frame(
predictions = predict(model, se = TRUE, newdata = C, type = "response")$fit,
lo = predict(model, se = TRUE, newdata = C)$fit - 1.96*predict(model, se = TRUE, newdata = C)$se.fit,
hi = predict(model, se = TRUE, newdata = C)$fit + 1.96*predict(model, se = TRUE, newdata = C)$se.fit,
predictor = C[, predictor]
)
return(preds)
}
#calculate predictions and prediction envelope for each level of CWD
cg_change_10 <- preds_cg_change(cg_change_lm, C_cg_change_10, "Delta_tc")
cg_change_50 <- preds_cg_change(cg_change_lm, C_cg_change_50, "Delta_tc")
cg_change_90 <- preds_cg_change(cg_change_lm, C_cg_change_90, "Delta_tc")
cg_change_10_no_out <- preds_cg_change(cg_change_lm_no_outliers, C_cg_change_10, "Delta_tc")
cg_change_50_no_out <- preds_cg_change(cg_change_lm_no_outliers, C_cg_change_50, "Delta_tc")
cg_change_90_no_out <- preds_cg_change(cg_change_lm_no_outliers, C_cg_change_90, "Delta_tc")
cg_change <- list(cg_change_10, cg_change_50, cg_change_90)
cg_change_no_out <- list(cg_change_10_no_out, cg_change_50_no_out, cg_change_90_no_out)
#generate the figure
tiff(filename="./outputs/Figure_2_cheatgrass_change_effect.tif",
type="cairo",
units="in",
width = 4,
height=3,
pointsize=12,
compression = "lzw",
res=600)
layout(matrix(c(1,2,3), nrow=1, ncol=3, byrow = TRUE))
par(mar = c(0,1,0,0), oma = c(6,4,2,2), bty = 'n')
panel_labels <- c("10% CWD", "50% CWD", "90% CWD")
for(i in c(1:3)){
plot(NA,
ylim = c(-0.06, 0.16),
xlim = c(-70, 10 ),
xlab = "",
ylab = "",
xaxt = "n",
yaxt = "n",
bg='grey60',
col = 'grey30',
pch = 21,
cex.lab = 1.5)
abline(h = 0, lty = 4, lwd = 1.3)
lines(cg_change[[i]]$predictions ~ cg_change[[i]]$predictor, lwd = 2, lty = 4, col = "#1b9e77")
lines(cg_change_no_out[[i]]$predictions ~ cg_change[[i]]$predictor, lwd = 2, lty = 1, col = "#1b9e77")
lines(cg_change_no_out[[i]]$lo ~ cg_change[[i]]$predictor, lwd = 1, lty = 1, col = "#1b9e77")
lines(cg_change_no_out[[i]]$hi ~ cg_change[[i]]$predictor, lwd = 1, lty = 1, col = "#1b9e77")
polygon(c(cg_change_no_out[[i]]$predictor, rev(cg_change_no_out[[i]]$predictor)), c(cg_change_no_out[[i]]$hi,
rev(cg_change_no_out[[i]]$lo)),
col = addTrans("#68EBC4",30), border = NA) #fills in the area between high and low confidence intervals
# I also hate this: plot the residuals ~ delta_tc for each level of CWD
points(
if(i == 1){
# part_resids[[i]][model$model[, "cwd_normal_cum"] < unname(quantile(compare$cwd_normal_cum, 0.3))] ~
#    model$model[model$model[, "cwd_normal_cum"] < unname(quantile(compare$cwd_normal_cum, 0.3)), "Delta_tc"]
compare[compare$cwd_normal_cum < unname(quantile(compare$cwd_normal_cum, 0.3)),]$delta_cg/100 ~
compare[compare$cwd_normal_cum < unname(quantile(compare$cwd_normal_cum, 0.3)),]$Delta_tc
}else if(i ==2){
compare[findInterval(compare$cwd_normal_cum, unname(quantile(compare$cwd_normal_cum, c(0.3, 0.7)))) == 1,]$delta_cg/100 ~
compare[findInterval(compare$cwd_normal_cum, unname(quantile(compare$cwd_normal_cum, c(0.3, 0.7)))) == 1,]$Delta_tc
#   part_resids[[i]][findInterval(model$model[, "cwd_normal_cum"], unname(quantile(compare$cwd_normal_cum, c(0.3, 0.7)))) == 1] ~
# model$model[findInterval(model$model[, "cwd_normal_cum"], unname(quantile(compare$cwd_normal_cum, c(0.3, 0.7)))) == 1, "Delta_tc"]
}else if (i == 3){
compare[compare$cwd_normal_cum > unname(quantile(compare$cwd_normal_cum, 0.7)),]$delta_cg/100 ~
compare[compare$cwd_normal_cum > unname(quantile(compare$cwd_normal_cum, 0.7)),]$Delta_tc
# part_resids[[i]][model$model[, "cwd_normal_cum"] > unname(quantile(compare$cwd_normal_cum, 0.7))] ~
#   model$model[model$model[, "cwd_normal_cum"] > unname(quantile(compare$cwd_normal_cum, 0.7)), "Delta_tc"]
},
bg='grey60',
col = 'grey30',
pch = 21,
cex = 1.5)
if(i == 1){
axis(side = 2, at = axTicks(2), labels = axTicks(2)*100)
# axis(side = 2, at = c(-0.1, 0, 0.1), labels = c(-10, 0, 10))
}
axis(side = 1, at = c(-40, -20, 0), labels = TRUE)
axis(side = 1, at = c(-50, -30, -10, 10), labels = FALSE, tcl = -.25)
text(x = -30, y = .07, labels = panel_labels[i], cex = 1.2)
}
mtext(side = 1, text = "Change in live canopy (%)", outer = TRUE, line = 2.6)
mtext(side = 2, text = "Change in cheatgrass cover (%)", outer = TRUE, line = 2.3)
dev.off()
compare_outliers <- compare[c(5,10), ]
compare2 <- compare[-c(5, 10), ]
compare_outliers[1]
compare_outliers
compare_outliers[1]
compare_outliers
compare_outliers[1, ]
points(compare_outliers[1, ]$delta_cg,
bg='grey60',
col = 'grey30',
pch = 21,
cex = 1.5)
points(compare_outliers[1, ]$delta_cg ~ compare_outliers[1, ]$cwd_normal_cum,
bg='grey60',
col = 'grey30',
pch = 21,
cex = 1.5)
compare_outliers[1, ]$delta_cg
compare_outliers[1, ]$cwd_normal_cum
points(compare_outliers[1, ]$delta_cg ~ compare_outliers[1, ]$Delta_tc,
bg='grey60',
col = 'grey30',
pch = 21,
cex = 1.5)
compare_outliers[1, ]$delta_cg
compare_outliers[1, ]$Delta_tc
points(compare_outliers[1, ]$delta_cg ~ compare_outliers[1, ]$Delta_tc,
bg='white',
col = 'grey30',
pch = 21,
cex = 1.5)
#generate the figure
tiff(filename="./outputs/Figure_2_cheatgrass_change_effect.tif",
type="cairo",
units="in",
width = 4,
height=3,
pointsize=12,
compression = "lzw",
res=600)
layout(matrix(c(1,2,3), nrow=1, ncol=3, byrow = TRUE))
par(mar = c(0,1,0,0), oma = c(6,4,2,2), bty = 'n')
panel_labels <- c("10% CWD", "50% CWD", "90% CWD")
for(i in c(1:3)){
plot(NA,
ylim = c(-0.06, 0.16),
xlim = c(-70, 10 ),
xlab = "",
ylab = "",
xaxt = "n",
yaxt = "n",
bg='grey60',
col = 'grey30',
pch = 21,
cex = 0.8,
cex.lab = 1.5)
abline(h = 0, lty = 4, lwd = 1.3)
lines(cg_change[[i]]$predictions ~ cg_change[[i]]$predictor, lwd = 2, lty = 4, col = "#1b9e77")
lines(cg_change_no_out[[i]]$predictions ~ cg_change[[i]]$predictor, lwd = 2, lty = 1, col = "#1b9e77")
lines(cg_change_no_out[[i]]$lo ~ cg_change[[i]]$predictor, lwd = 1, lty = 1, col = "#1b9e77")
lines(cg_change_no_out[[i]]$hi ~ cg_change[[i]]$predictor, lwd = 1, lty = 1, col = "#1b9e77")
polygon(c(cg_change_no_out[[i]]$predictor, rev(cg_change_no_out[[i]]$predictor)), c(cg_change_no_out[[i]]$hi,
rev(cg_change_no_out[[i]]$lo)),
col = addTrans("#68EBC4",30), border = NA) #fills in the area between high and low confidence intervals
# I also hate this: plot the residuals ~ delta_tc for each level of CWD
if(i == 1){
points(compare2[compare2$cwd_normal_cum < unname(quantile(compare2$cwd_normal_cum, 0.3)),]$delta_cg/100 ~
compare2[compare2$cwd_normal_cum < unname(quantile(compare2$cwd_normal_cum, 0.3)),]$Delta_tc,
bg='grey60',
col = 'grey30',
pch = 21,
cex = 1.5)
}else if(i ==2){
points(compare2[findInterval(compare2$cwd_normal_cum, unname(quantile(compare2$cwd_normal_cum, c(0.3, 0.7)))) == 1,]$delta_cg/100 ~
compare2[findInterval(compare2$cwd_normal_cum, unname(quantile(compare2$cwd_normal_cum, c(0.3, 0.7)))) == 1,]$Delta_tc,
bg='grey60',
col = 'grey30',
pch = 21,
cex = 1.5)
points(compare_outliers[1, ]$delta_cg ~ compare_outliers[1, ]$Delta_tc,
bg='white',
col = 'grey30',
pch = 21,
cex = 1.5)
}else if (i == 3){
points(compare2[compare2$cwd_normal_cum > unname(quantile(compare2$cwd_normal_cum, 0.7)),]$delta_cg/100 ~
compare2[compare2$cwd_normal_cum > unname(quantile(compare2$cwd_normal_cum, 0.7)),]$Delta_tc,
bg='grey60',
col = 'grey30',
pch = 21,
cex = 1.5)
}
if(i == 1){
axis(side = 2, at = axTicks(2), labels = axTicks(2)*100)
# axis(side = 2, at = c(-0.1, 0, 0.1), labels = c(-10, 0, 10))
}
axis(side = 1, at = c(-40, -20, 0), labels = TRUE)
axis(side = 1, at = c(-50, -30, -10, 10), labels = FALSE, tcl = -.25)
text(x = -30, y = .07, labels = panel_labels[i], cex = 1.2)
}
mtext(side = 1, text = "Change in live canopy (%)", outer = TRUE, line = 2.6)
mtext(side = 2, text = "Change in cheatgrass cover (%)", outer = TRUE, line = 2.3)
dev.off()
#generate the figure
tiff(filename="./outputs/Figure_2_cheatgrass_change_effect.tif",
type="cairo",
units="in",
width = 4,
height=3,
pointsize=12,
compression = "lzw",
res=600)
layout(matrix(c(1,2,3), nrow=1, ncol=3, byrow = TRUE))
par(mar = c(0,1,0,0), oma = c(6,4,2,2), bty = 'n')
panel_labels <- c("10% CWD", "50% CWD", "90% CWD")
for(i in c(1:3)){
plot(NA,
ylim = c(-0.06, 0.16),
xlim = c(-70, 10 ),
xlab = "",
ylab = "",
xaxt = "n",
yaxt = "n",
bg='grey60',
col = 'grey30',
pch = 21,
cex = 0.8,
cex.lab = 1.5)
abline(h = 0, lty = 4, lwd = 1.3)
lines(cg_change[[i]]$predictions ~ cg_change[[i]]$predictor, lwd = 2, lty = 4, col = "#1b9e77")
lines(cg_change_no_out[[i]]$predictions ~ cg_change[[i]]$predictor, lwd = 2, lty = 1, col = "#1b9e77")
lines(cg_change_no_out[[i]]$lo ~ cg_change[[i]]$predictor, lwd = 1, lty = 1, col = "#1b9e77")
lines(cg_change_no_out[[i]]$hi ~ cg_change[[i]]$predictor, lwd = 1, lty = 1, col = "#1b9e77")
polygon(c(cg_change_no_out[[i]]$predictor, rev(cg_change_no_out[[i]]$predictor)), c(cg_change_no_out[[i]]$hi,
rev(cg_change_no_out[[i]]$lo)),
col = addTrans("#68EBC4",30), border = NA) #fills in the area between high and low confidence intervals
# I also hate this: plot the residuals ~ delta_tc for each level of CWD
if(i == 1){
points(compare2[compare2$cwd_normal_cum < unname(quantile(compare2$cwd_normal_cum, 0.3)),]$delta_cg/100 ~
compare2[compare2$cwd_normal_cum < unname(quantile(compare2$cwd_normal_cum, 0.3)),]$Delta_tc,
bg='grey60',
col = 'grey30',
pch = 21,
cex = 1.5)
}else if(i ==2){
points(compare2[findInterval(compare2$cwd_normal_cum, unname(quantile(compare2$cwd_normal_cum, c(0.3, 0.7)))) == 1,]$delta_cg/100 ~
compare2[findInterval(compare2$cwd_normal_cum, unname(quantile(compare2$cwd_normal_cum, c(0.3, 0.7)))) == 1,]$Delta_tc,
bg='grey60',
col = 'grey30',
pch = 21,
cex = 1.5)
points(compare_outliers[1, ]$delta_cg ~ compare_outliers[1, ]$Delta_tc,
bg='white',
col = 'grey30',
pch = 21,
cex = 1.5)
}else if (i == 3){
points(compare2[compare2$cwd_normal_cum > unname(quantile(compare2$cwd_normal_cum, 0.7)),]$delta_cg/100 ~
compare2[compare2$cwd_normal_cum > unname(quantile(compare2$cwd_normal_cum, 0.7)),]$Delta_tc,
bg='grey60',
col = 'grey30',
pch = 21,
cex = 1.5)
}
if(i == 1){
axis(side = 2, at = axTicks(2), labels = axTicks(2)*100)
# axis(side = 2, at = c(-0.1, 0, 0.1), labels = c(-10, 0, 10))
}
axis(side = 1, at = c(-40, -20, 0), labels = TRUE)
axis(side = 1, at = c(-50, -30, -10, 10), labels = FALSE, tcl = -.25)
text(x = -30, y = .07, labels = panel_labels[i], cex = 1.2)
}
mtext(side = 1, text = "Change in live canopy (%)", outer = TRUE, line = 2.6)
mtext(side = 2, text = "Change in cheatgrass cover (%)", outer = TRUE, line = 2.3)
dev.off()
layout(matrix(c(1,2,3), nrow=1, ncol=3, byrow = TRUE))
par(mar = c(0,1,0,0), oma = c(6,4,2,2), bty = 'n')
panel_labels <- c("10% CWD", "50% CWD", "90% CWD")
for(i in c(1:3)){
plot(NA,
ylim = c(-0.06, 0.16),
xlim = c(-70, 10 ),
xlab = "",
ylab = "",
xaxt = "n",
yaxt = "n",
bg='grey60',
col = 'grey30',
pch = 21,
cex = 0.8,
cex.lab = 1.5)
abline(h = 0, lty = 4, lwd = 1.3)
lines(cg_change[[i]]$predictions ~ cg_change[[i]]$predictor, lwd = 2, lty = 4, col = "#1b9e77")
lines(cg_change_no_out[[i]]$predictions ~ cg_change[[i]]$predictor, lwd = 2, lty = 1, col = "#1b9e77")
lines(cg_change_no_out[[i]]$lo ~ cg_change[[i]]$predictor, lwd = 1, lty = 1, col = "#1b9e77")
lines(cg_change_no_out[[i]]$hi ~ cg_change[[i]]$predictor, lwd = 1, lty = 1, col = "#1b9e77")
polygon(c(cg_change_no_out[[i]]$predictor, rev(cg_change_no_out[[i]]$predictor)), c(cg_change_no_out[[i]]$hi,
rev(cg_change_no_out[[i]]$lo)),
col = addTrans("#68EBC4",30), border = NA) #fills in the area between high and low confidence intervals
# I also hate this: plot the residuals ~ delta_tc for each level of CWD
if(i == 1){
points(compare2[compare2$cwd_normal_cum < unname(quantile(compare2$cwd_normal_cum, 0.3)),]$delta_cg/100 ~
compare2[compare2$cwd_normal_cum < unname(quantile(compare2$cwd_normal_cum, 0.3)),]$Delta_tc,
bg='grey60',
col = 'grey30',
pch = 21,
cex = 1.5)
}else if(i ==2){
points(compare2[findInterval(compare2$cwd_normal_cum, unname(quantile(compare2$cwd_normal_cum, c(0.3, 0.7)))) == 1,]$delta_cg/100 ~
compare2[findInterval(compare2$cwd_normal_cum, unname(quantile(compare2$cwd_normal_cum, c(0.3, 0.7)))) == 1,]$Delta_tc,
bg='grey60',
col = 'grey30',
pch = 21,
cex = 1.5)
points(compare_outliers[1, ]$delta_cg ~ compare_outliers[1, ]$Delta_tc,
bg='white',
col = 'grey30',
pch = 21,
cex = 1.5)
}else if (i == 3){
points(compare2[compare2$cwd_normal_cum > unname(quantile(compare2$cwd_normal_cum, 0.7)),]$delta_cg/100 ~
compare2[compare2$cwd_normal_cum > unname(quantile(compare2$cwd_normal_cum, 0.7)),]$Delta_tc,
bg='grey60',
col = 'grey30',
pch = 21,
cex = 1.5)
}
if(i == 1){
axis(side = 2, at = axTicks(2), labels = axTicks(2)*100)
# axis(side = 2, at = c(-0.1, 0, 0.1), labels = c(-10, 0, 10))
}
axis(side = 1, at = c(-40, -20, 0), labels = TRUE)
axis(side = 1, at = c(-50, -30, -10, 10), labels = FALSE, tcl = -.25)
text(x = -30, y = .07, labels = panel_labels[i], cex = 1.2)
}
mtext(side = 1, text = "Change in live canopy (%)", outer = TRUE, line = 2.6)
mtext(side = 2, text = "Change in cheatgrass cover (%)", outer = TRUE, line = 2.3)
points(compare_outliers[1, ]$delta_cg ~ compare_outliers[1, ]$Delta_tc,
bg='white',
col = 'grey30',
pch = 21,
cex = 1.5)
points(compare_outliers[1, ]$delta_cg ~ compare_outliers[1, ]$Delta_tc,
bg='black',
col = 'grey30',
pch = 21,
cex = 1.5)
compare_outliers[1, ]$delta_cg
compare_outliers[1, ]$Delta_tc
delta_cg
compare_outliers[1, ]$delta_cg/100
#generate the figure
tiff(filename="./outputs/Figure_2_cheatgrass_change_effect.tif",
type="cairo",
units="in",
width = 4,
height=3,
pointsize=12,
compression = "lzw",
res=600)
layout(matrix(c(1,2,3), nrow=1, ncol=3, byrow = TRUE))
par(mar = c(0,1,0,0), oma = c(6,4,2,2), bty = 'n')
panel_labels <- c("10% CWD", "50% CWD", "90% CWD")
for(i in c(1:3)){
plot(NA,
ylim = c(-0.06, 0.16),
xlim = c(-70, 10 ),
xlab = "",
ylab = "",
xaxt = "n",
yaxt = "n",
bg='grey60',
col = 'grey30',
pch = 21,
cex = 0.8,
cex.lab = 1.5)
abline(h = 0, lty = 4, lwd = 1.3)
lines(cg_change[[i]]$predictions ~ cg_change[[i]]$predictor, lwd = 2, lty = 4, col = "#1b9e77")
lines(cg_change_no_out[[i]]$predictions ~ cg_change[[i]]$predictor, lwd = 2, lty = 1, col = "#1b9e77")
lines(cg_change_no_out[[i]]$lo ~ cg_change[[i]]$predictor, lwd = 1, lty = 1, col = "#1b9e77")
lines(cg_change_no_out[[i]]$hi ~ cg_change[[i]]$predictor, lwd = 1, lty = 1, col = "#1b9e77")
polygon(c(cg_change_no_out[[i]]$predictor, rev(cg_change_no_out[[i]]$predictor)), c(cg_change_no_out[[i]]$hi,
rev(cg_change_no_out[[i]]$lo)),
col = addTrans("#68EBC4",30), border = NA) #fills in the area between high and low confidence intervals
# I also hate this: plot the residuals ~ delta_tc for each level of CWD
if(i == 1){
points(compare2[compare2$cwd_normal_cum < unname(quantile(compare2$cwd_normal_cum, 0.3)),]$delta_cg/100 ~
compare2[compare2$cwd_normal_cum < unname(quantile(compare2$cwd_normal_cum, 0.3)),]$Delta_tc,
bg='grey60',
col = 'grey30',
pch = 21,
cex = 1.5)
}else if(i ==2){
points(compare2[findInterval(compare2$cwd_normal_cum, unname(quantile(compare2$cwd_normal_cum, c(0.3, 0.7)))) == 1,]$delta_cg/100 ~
compare2[findInterval(compare2$cwd_normal_cum, unname(quantile(compare2$cwd_normal_cum, c(0.3, 0.7)))) == 1,]$Delta_tc,
bg='grey60',
col = 'grey30',
pch = 21,
cex = 1.5)
points(compare_outliers[1, ]$delta_cg/100 ~ compare_outliers[1, ]$Delta_tc,
bg='black',
col = 'grey30',
pch = 21,
cex = 1.5)
}else if (i == 3){
points(compare2[compare2$cwd_normal_cum > unname(quantile(compare2$cwd_normal_cum, 0.7)),]$delta_cg/100 ~
compare2[compare2$cwd_normal_cum > unname(quantile(compare2$cwd_normal_cum, 0.7)),]$Delta_tc,
bg='grey60',
col = 'grey30',
pch = 21,
cex = 1.5)
points(compare_outliers[2, ]$delta_cg/100 ~ compare_outliers[2, ]$Delta_tc,
bg='black',
col = 'grey30',
pch = 21,
cex = 1.5)
}
if(i == 1){
axis(side = 2, at = axTicks(2), labels = axTicks(2)*100)
# axis(side = 2, at = c(-0.1, 0, 0.1), labels = c(-10, 0, 10))
}
axis(side = 1, at = c(-40, -20, 0), labels = TRUE)
axis(side = 1, at = c(-50, -30, -10, 10), labels = FALSE, tcl = -.25)
text(x = -30, y = .07, labels = panel_labels[i], cex = 1.2)
}
mtext(side = 1, text = "Change in live canopy (%)", outer = TRUE, line = 2.6)
mtext(side = 2, text = "Change in cheatgrass cover (%)", outer = TRUE, line = 2.3)
dev.off()
#generate the figure
tiff(filename="./outputs/Figure_2_cheatgrass_change_effect.tif",
type="cairo",
units="in",
width = 4,
height=3,
pointsize=12,
compression = "lzw",
res=600)
layout(matrix(c(1,2,3), nrow=1, ncol=3, byrow = TRUE))
par(mar = c(0,1,0,0), oma = c(6,4,2,2), bty = 'n')
panel_labels <- c("10% CWD", "50% CWD", "90% CWD")
for(i in c(1:3)){
plot(NA,
ylim = c(-0.06, 0.16),
xlim = c(-70, 10 ),
xlab = "",
ylab = "",
xaxt = "n",
yaxt = "n",
bg='grey60',
col = 'grey30',
pch = 21,
cex = 0.8,
cex.lab = 1.5)
abline(h = 0, lty = 4, lwd = 1.3)
lines(cg_change[[i]]$predictions ~ cg_change[[i]]$predictor, lwd = 2, lty = 4, col = "#1b9e77")
lines(cg_change_no_out[[i]]$predictions ~ cg_change[[i]]$predictor, lwd = 2, lty = 1, col = "#1b9e77")
lines(cg_change_no_out[[i]]$lo ~ cg_change[[i]]$predictor, lwd = 1, lty = 1, col = "#1b9e77")
lines(cg_change_no_out[[i]]$hi ~ cg_change[[i]]$predictor, lwd = 1, lty = 1, col = "#1b9e77")
polygon(c(cg_change_no_out[[i]]$predictor, rev(cg_change_no_out[[i]]$predictor)), c(cg_change_no_out[[i]]$hi,
rev(cg_change_no_out[[i]]$lo)),
col = addTrans("#68EBC4",30), border = NA) #fills in the area between high and low confidence intervals
# I also hate this: plot the residuals ~ delta_tc for each level of CWD
if(i == 1){
points(compare2[compare2$cwd_normal_cum < unname(quantile(compare2$cwd_normal_cum, 0.3)),]$delta_cg/100 ~
compare2[compare2$cwd_normal_cum < unname(quantile(compare2$cwd_normal_cum, 0.3)),]$Delta_tc,
bg='grey60',
col = 'grey30',
pch = 21,
cex = 1.2)
}else if(i ==2){
points(compare2[findInterval(compare2$cwd_normal_cum, unname(quantile(compare2$cwd_normal_cum, c(0.3, 0.7)))) == 1,]$delta_cg/100 ~
compare2[findInterval(compare2$cwd_normal_cum, unname(quantile(compare2$cwd_normal_cum, c(0.3, 0.7)))) == 1,]$Delta_tc,
bg='grey60',
col = 'grey30',
pch = 21,
cex = 1.2)
points(compare_outliers[1, ]$delta_cg/100 ~ compare_outliers[1, ]$Delta_tc,
bg='white',
col = 'grey30',
pch = 21,
cex = 1.2)
}else if (i == 3){
points(compare2[compare2$cwd_normal_cum > unname(quantile(compare2$cwd_normal_cum, 0.7)),]$delta_cg/100 ~
compare2[compare2$cwd_normal_cum > unname(quantile(compare2$cwd_normal_cum, 0.7)),]$Delta_tc,
bg='grey60',
col = 'grey30',
pch = 21,
cex = 1.2)
points(compare_outliers[2, ]$delta_cg/100 ~ compare_outliers[2, ]$Delta_tc,
bg='white',
col = 'grey30',
pch = 21,
cex = 1.2)
}
if(i == 1){
axis(side = 2, at = axTicks(2), labels = axTicks(2)*100)
# axis(side = 2, at = c(-0.1, 0, 0.1), labels = c(-10, 0, 10))
}
axis(side = 1, at = c(-40, -20, 0), labels = TRUE)
axis(side = 1, at = c(-50, -30, -10, 10), labels = FALSE, tcl = -.25)
text(x = -30, y = .07, labels = panel_labels[i], cex = 1.2)
}
mtext(side = 1, text = "Change in live canopy (%)", outer = TRUE, line = 2.6)
mtext(side = 2, text = "Change in cheatgrass cover (%)", outer = TRUE, line = 2.3)
dev.off()
